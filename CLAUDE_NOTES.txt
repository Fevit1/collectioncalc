# Claude Working Notes - CollectionCalc Project

## Executive Summary

**Purpose:** This document helps Claude quickly get up to speed when starting a new session with Mike on the CollectionCalc project.

**The Project:** CollectionCalc is an AI-powered comic book valuation tool. The flagship feature "Slab Worthy?" uses patent-pending multi-angle photography to assess whether comics are worth professional grading.

**The Human:** Mike is a Product Manager (not a developer). He's comfortable with Git, Render deployments, and SQL queries, but needs guidance on complex debugging and architecture decisions. He wants Claude to push back and share knowledge proactively.

**Current State (v4.0):**
- Core features working: Manual Entry, Photo Upload, Slab Worthy
- **ðŸŽ‰ BARCODE SCANNING LIVE** â€” Docker deployment with pyzbar/libzbar0
- **ðŸŽ‰ BARCODE STORAGE LIVE** â€” New sales automatically scanned and stored
- eBay Collector extension v1.0.3, Whatnot Valuator v2.41.2

**Next Priority:** Phase 3 â€” Backfill existing images with barcode data

---

## Session 22 Summary (February 2, 2026)

### Docker Migration COMPLETE âœ…
- Production now runs on `collectioncalc-docker.onrender.com`
- Old Python service SUSPENDED (saves $7/mo)
- Updated Whatnot extension (`collectioncalc.js` API URL)
- Updated eBay extension (`popup.js` API URL)
- Fixed Mike's `deploy` PowerShell alias (new service ID: `srv-d5vcjqqli9vc73a5a730`)

### Phase 2: Barcode Storage COMPLETE âœ…
- Added database columns: `upc_main`, `upc_addon`, `is_reprint` to both `market_sales` and `ebay_sales`
- Updated wsgi.py to v4.0 with `scan_barcode_from_base64()` utility
- `/api/sales/record` now scans barcodes from uploaded images
- `/api/images/upload-for-sale` also scans barcodes
- `/health` returns `{"barcode": true, "version": "4.0"}`

### Phase 3: Backfill â€” NOT DONE YET
Need to create `/api/admin/backfill-barcodes` endpoint to scan existing R2 images

### Other
- Created weekly eBay collection schedule (238 titles across 7 days)
- Goal: 2,000 sales/day (~34 searches at 60 sales each)

---

## Quick Reference

### Deployment Commands
```powershell
# Backend (Render Docker)
git add .; git commit -m "message"; git push; deploy

# Frontend (Cloudflare)
git add .; git commit -m "message"; git push; purge
```

### Service IDs
- Docker service: `srv-d5vcjqqli9vc73a5a730`
- API URL: `https://collectioncalc-docker.onrender.com`

### Test Barcode
```bash
curl https://collectioncalc-docker.onrender.com/health
# Returns: {"barcode":true,"status":"ok","version":"4.0"}
```

---

*Last updated: February 2, 2026 (Session 22)*
*Next priority: Phase 3 â€” Backfill existing images with barcode data*
