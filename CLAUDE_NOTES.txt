# Claude Working Notes - CollectionCalc / Slab Worthy Project

## Executive Summary

**Purpose:** This document helps Claude quickly get up to speed when starting a new session with Mike on the Slab Worthy project.

**The Project:** Slab Worthy is an AI-powered comic grading tool. The flagship feature uses patent-pending multi-angle photography to assess whether comics are worth professional grading. Powered by CollectionCalc backend.

**The Human:** Mike is a Product Manager (not a developer). He's comfortable with Git, Render deployments, and SQL queries, but needs guidance on complex debugging and architecture decisions. He wants Claude to push back and share knowledge proactively.

**Current State (v4.2.1):**
- **REBRANDED TO SLAB WORTHY** - slabworthy.com is live!
- FMV uses eBay + Whatnot data (10x more sales!)
- Reprint filter active (Spawn #1 fix)
- Barcode scanning infrastructure ready
- eBay Collector extension v1.0.3, Whatnot Valuator v2.41.2

---

## ðŸš¨ IMMEDIATE ACTION ITEMS

### Broken Links in Production
- [ ] `/privacy.html` - 404, needs to be created
- [ ] `/terms.html` - 404, needs to be created  
- [ ] `support@slabworthy.com` - verify email is set up

### Testing Needed
- [ ] **Mobile testing** - full Slab Worthy grading flow on phone
- [ ] Comic-shaped upload boxes on small screens
- [ ] Image picker UX on mobile (see UX improvement below)

### Branding Decisions Needed
- [ ] **collectioncalc.com** - currently shows Slab Worthy branding. Should it stay CollectionCalc-branded as the backend hub?
- [ ] **Email templates** - verification/password reset emails probably still say "CollectionCalc"
- [ ] **Chrome extensions** - still reference CollectionCalc
- [ ] **Tone consideration** - "Slab Worthy" is casual/playful phrase ("Dude, that's slab worthy!"). Current design may be too formal. Consider more playful branding?

---

## Session 23 Summary (February 2, 2026)

### Major Wins
1. **FMV Now Uses eBay + Whatnot Data (v4.2)**
   - `/api/sales/fmv` queries BOTH tables
   - ASM #300: 6 Whatnot + 53 eBay = 59 total sales
   - Response includes `sources: { whatnot: X, ebay: Y }`

2. **Reprint Filter (v4.2.1)**
   - `is_reprint = false` filter on both tables
   - Text filters: "reprint", "2nd print", "3rd print", etc.
   - Fixes Spawn #1 valuation pollution

3. **Full Slab Worthy Rebrand**
   - slabworthy.com â†’ custom domain on Cloudflare Pages
   - New branding: "Slab Worthyâ„¢ - AI for Comic Collectors"
   - Removed Photo Upload tab
   - Slab Worthy? is now default tab
   - Comic-shaped upload boxes (7:10 cover, 1:6 spine, 14:10 centerfold)
   - Centerfold has dotted center line
   - Desktop: "Upload" text, hidden "Take Photo" button
   - Footer: Contact, Privacy, Terms + "Powered by CollectionCalcâ„¢ Â© 2026"

### Barcode Backfill - Skipped
- Endpoints created but Whatnot images don't show barcodes
- Live stream screenshots with barcode corner cropped
- Will be useful for: Slab Worthy user photos, eBay Collector images

---

## Technical Debt

### wsgi.py Refactoring Needed
- Currently ~1,900 lines and growing
- Recommendation: Split at ~2,500 lines using Flask Blueprints
- Suggested structure:
  - `routes/auth.py` - authentication endpoints
  - `routes/admin.py` - admin/NLQ endpoints  
  - `routes/sales.py` - FMV, market data
  - `routes/images.py` - R2 upload, barcode scanning
  - `routes/grading.py` - extraction, grading endpoints

### Dead Code
- Barcode backfill endpoints (`/api/admin/backfill-barcodes`, `/api/admin/barcode-stats`) - functional but useless since Whatnot images don't have visible barcodes

---

## Business Vision

### "Worthy" Brand Family
- **slabworthy.com** â€” Comics (CGC, CBCS) âœ… LIVE
- **coinworthy.com** â€” Coins (PCGS, NGC) - future
- **cardworthy.com** â€” Cards (PSA, BGS) - future
- **stampworthy.com** â€” Stamps (PSA, PSE) - future

All share one backend (CollectionCalc API). Same pattern:
```
Photo â†’ AI Vision â†’ Grade Estimate â†’ Market Value â†’ "Worth grading?"
```

---

## Quick Reference

### Deployment Commands
```powershell
# Backend (Render Docker)
git add .; git commit -m "message"; git push; deploy

# Frontend (Cloudflare)  
git add .; git commit -m "message"; git push; purge
```

### URLs
- **Frontend:** slabworthy.com (also collectioncalc.com)
- **API:** collectioncalc-docker.onrender.com
- **Service ID:** srv-d5vcjqqli9vc73a5a730

### Test Endpoints
```bash
curl https://collectioncalc-docker.onrender.com/health
# Returns: {"barcode":true,"status":"ok","version":"4.2.1"}

curl "https://collectioncalc-docker.onrender.com/api/sales/fmv?title=spider-man&issue=300"
```

---

## UX Improvements Identified

### Mobile Image Picker
Current: Standard file picker shows tiny thumbnails
Desired: Gallery-style view like native camera app on Pixel
Options to explore:
- Custom image picker component
- PWA with file system access API
- Native-like gallery grid before upload

---

*Last updated: February 2, 2026 (Session 23)*
*Version: 4.2.1*
